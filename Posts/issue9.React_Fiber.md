# React Fiber - What & Why & How?

作为一个优秀的 React 开发者，肯定听说过 **React Fiber**，伴随这个概念的，还有 React 的**可中断执行**概念，那么这两个概念之间存在着怎样的关系呢？

这篇文章里，我们会试图回答以下几个问题：
1. 什么是 React Fiber？
2. 为什么需要 React Fiber？
3. 为什么没有 Vue Fiber？
4. React 是怎么结合 React Fiber 来支持可中断执行的？

---
## 为什么需要 React Fiber？

首先，我们知道在浏览器中，有一个**渲染线程**，这个单一的渲染线程需要完成许多不同的任务，其中最重要的就是 JavaScript 引擎执行 + GUI 页面渲染。考虑到这是一个单一的线程，很显然 JavaScript 引擎执行和 GUI 页面渲染这两个任务是互斥的，**也就是说不可能同时执行**！

那么在这种场景下，我们想象一下，假设我们的 JavaScript 代码非常的复杂，霸占了该线程的所有资源，那么从用户侧视角来看，我们的感官就是页面整个卡死了。这显然带来的用户体验是非常差的。因此，我们有了第一个论点 —— ***JavaScript 引擎不能长期霸占渲染线程资源***

那么简单的想象一下，有什么办法解决这个问题呢？其实有三个方案：
1. 让我们 JavaScript 引擎的任务越快越好
2. 快速响应用户，让我们 JavaScript 任务向用户的交互让步
3. webworker 多线程

其中方案 1 的代表就是 Vue，Vue 的响应式机制可以精准的更新单一节点，让任务执行的非常快速。而 React 则采用了方案 2，通过一系列调度机制和优先级机制，来快速响应用户的高优操作。对于方案 3，目前还没有一个非常成熟的方案，因为保持状态和视图的一致性仍然是一个挑战。

那么我们专注一下 React，在 React 的一次更新操作中，有一个被称作 **Reconciliation** 的阶段，在这个阶段中 React 要对比更新前后两次 DOM 树的差异(diff 算法)，还需要同步并且提交更新内容。
在 Reconciliatioon 阶段中，React 会一直霸占浏览器资源，因此我们需要想办法优化这一部分的体验！

React 通过引入 Fiber 架构，来让自己的 Reconciliation 变成一个**可中断**的过程，因此

## What？

什么是 React Fiber？用最通俗易懂的方式解释，就是一个**执行单元**，